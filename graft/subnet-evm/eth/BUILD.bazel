load("@io_bazel_rules_go//go:def.bzl", "go_library")
load("//.bazel:defs.bzl", "graft_go_test_900s")

go_library(
    name = "eth",
    srcs = [
        "api.go",
        "api_admin.go",
        "api_backend.go",
        "api_debug.go",
        "backend.go",
        "bloombits.go",
        "chain_with_final_block.go",
        "state_accessor.go",
    ],
    importpath = "github.com/ava-labs/avalanchego/graft/subnet-evm/eth",
    visibility = ["//visibility:public"],
    deps = [
        "//graft/evm/core/state/pruner",
        "//graft/evm/rpc",
        "//graft/subnet-evm/commontype",
        "//graft/subnet-evm/consensus",
        "//graft/subnet-evm/core",
        "//graft/subnet-evm/core/extstate",
        "//graft/subnet-evm/core/txpool",
        "//graft/subnet-evm/core/txpool/legacypool",
        "//graft/subnet-evm/eth/ethconfig",
        "//graft/subnet-evm/eth/filters",
        "//graft/subnet-evm/eth/gasprice",
        "//graft/subnet-evm/eth/tracers",
        "//graft/subnet-evm/internal/ethapi",
        "//graft/subnet-evm/internal/shutdowncheck",
        "//graft/subnet-evm/miner",
        "//graft/subnet-evm/node",
        "//graft/subnet-evm/params",
        "//utils/timer/mockable",
        "//version",
        "//vms/evm/sync/customrawdb",
        "@com_github_ava_labs_libevm//accounts",
        "@com_github_ava_labs_libevm//common",
        "@com_github_ava_labs_libevm//common/bitutil",
        "@com_github_ava_labs_libevm//common/hexutil",
        "@com_github_ava_labs_libevm//core/bloombits",
        "@com_github_ava_labs_libevm//core/rawdb",
        "@com_github_ava_labs_libevm//core/state",
        "@com_github_ava_labs_libevm//core/types",
        "@com_github_ava_labs_libevm//core/vm",
        "@com_github_ava_labs_libevm//crypto",
        "@com_github_ava_labs_libevm//ethdb",
        "@com_github_ava_labs_libevm//event",
        "@com_github_ava_labs_libevm//log",
        "@com_github_ava_labs_libevm//params",
        "@com_github_ava_labs_libevm//rlp",
        "@com_github_ava_labs_libevm//trie",
        "@com_github_ava_labs_libevm//triedb",
    ],
)

graft_go_test_900s(
    name = "eth_test",
    srcs = [
        "api_backend_test.go",
        "api_debug_test.go",
    ],
    embed = [":eth"],
    deps = [
        "//graft/subnet-evm/core/extstate",
        "@com_github_ava_labs_libevm//common",
        "@com_github_ava_labs_libevm//core/rawdb",
        "@com_github_ava_labs_libevm//core/state",
        "@com_github_ava_labs_libevm//core/types",
        "@com_github_ava_labs_libevm//crypto",
        "@com_github_ava_labs_libevm//rlp",
        "@com_github_ava_labs_libevm//triedb",
        "@com_github_davecgh_go_spew//spew",
        "@com_github_holiman_uint256//:uint256",
        "@com_github_stretchr_testify//assert",
        "@com_github_stretchr_testify//require",
        "@org_golang_x_exp//slices",
    ],
)
