name: C-Chain Re-Execution Benchmark GH Runner

on:
  pull_request:

jobs:
  c-chain-reexecution-pr-gh-runner: # Smoke test on GitHub hosted runner
    if: ${{ github.event_name == 'pull_request' && github.event.pull_request.head.repo.full_name == 'ava-labs/avalanchego'}}
    permissions:
      id-token: write
      contents: write
    runs-on: 'ubuntu-latest'
    steps:
      - uses: actions/checkout@v4
      - name: Run C-Chain Re-Execution Benchmark
        uses: ./.github/actions/c-chain-reexecution-benchmark
        with:
          start-block: 101
          end-block: 1000
          source-block-dir: s3://avalanchego-bootstrap-testing/cchain-mainnet-blocks-1m-ldb.zip
          current-state-dir: s3://avalanchego-bootstrap-testing/cchain-current-state-hashdb-full-100.zip
          prometheus-username: ${{ secrets.PROMETHEUS_ID || '' }}
          prometheus-password: ${{ secrets.PROMETHEUS_PASSWORD || '' }}
          aws-role: ${{ secrets.AWS_S3_READ_ONLY_ROLE }}
          aws-region: 'us-east-2'
          github-token: ${{ secrets.GITHUB_TOKEN }}
